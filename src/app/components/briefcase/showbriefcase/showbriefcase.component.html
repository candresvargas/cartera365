<div class="p-6">

  <!-- Indicadores de Cartera -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white p-4 rounded shadow">
      <h3 class="text-gray-500 text-sm">Total Desembolsado</h3>
      <p class="text-xl font-bold">${{ totalDesembolsado }}</p>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h3 class="text-gray-500 text-sm">Total Recuperado</h3>
      <p class="text-xl font-bold">${{ totalRecuperado }}</p>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h3 class="text-gray-500 text-sm">Total Pendiente</h3>
      <p class="text-xl font-bold">${{ totalPendiente }}</p>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h3 class="text-gray-500 text-sm">% Mora</h3>
      <p class="text-xl font-bold">{{ porcentajeMora | number:'1.0-2' }}%</p>
    </div>
  </div>

  <!-- Filtros -->
  <div class="flex flex-wrap gap-4 mb-4">
    <input type="text" pInputText placeholder="Buscar cliente" [(ngModel)]="filterCliente" (ngModelChange)="applyFilters()" class="p-inputtext-sm"/>
    <input type="text" pInputText placeholder="Producto" [(ngModel)]="filterProducto" (ngModelChange)="applyFilters()" class="p-inputtext-sm"/>
    <p-dropdown [options]="estados" optionLabel="label" placeholder="Estado" [(ngModel)]="filterEstado" (ngModelChange)="applyFilters()" class="p-inputtext-sm"></p-dropdown>
    <p-calendar [(ngModel)]="filterFechaDesde" placeholder="Desde" (ngModelChange)="applyFilters()" class="p-inputtext-sm"></p-calendar>
    <p-calendar [(ngModel)]="filterFechaHasta" placeholder="Hasta" (ngModelChange)="applyFilters()" class="p-inputtext-sm"></p-calendar>
  </div>

  <!-- Botón Crear Cartera -->
  <div class="flex justify-end mb-4">
    <button pButton label="Crear Cartera" icon="pi pi-plus" class="p-button-success" routerLink="/cartera/crear"></button>
  </div>

  <!-- Tablas por estado -->
  <div class="mb-6">
    <h3 class="text-lg font-semibold mb-2">Al día</h3>
    <p-table [value]="alDia" [paginator]="true" [rows]="5">
      <ng-template pTemplate="header">
        <tr>
          <th>Cliente</th>
          <th>Producto</th>
          <th>Capital</th>
          <th>Intereses</th>
          <th>Mora</th>
          <th>Fecha Desembolso</th>
          <th>Fecha Vencimiento</th>
          <th>Total Pagado</th>
          <th>Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.clienteNombre }}</td>
          <td>{{ item.producto }}</td>
          <td>{{ item.capital | currency }}</td>
          <td>{{ item.intereses | currency }}</td>
          <td>{{ item.mora | currency }}</td>
          <td>{{ item.fechaDesembolso | date:'shortDate' }}</td>
          <td>{{ item.fechaVencimiento | date:'shortDate' }}</td>
          <td>{{ item.totalPagado | currency }}</td>
          <td>
            <button pButton icon="pi pi-trash" class="p-button-danger p-button-sm" (click)="onDelete(item.id)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div class="mb-6">
    <h3 class="text-lg font-semibold mb-2">En mora</h3>
    <p-table [value]="enMora" [paginator]="true" [rows]="5">
      <ng-template pTemplate="header">
        <tr>
          <th>Cliente</th>
          <th>Producto</th>
          <th>Capital</th>
          <th>Intereses</th>
          <th>Mora</th>
          <th>Fecha Desembolso</th>
          <th>Fecha Vencimiento</th>
          <th>Total Pagado</th>
          <th>Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.clienteNombre }}</td>
          <td>{{ item.producto }}</td>
          <td>{{ item.capital | currency }}</td>
          <td>{{ item.intereses | currency }}</td>
          <td>{{ item.mora | currency }}</td>
          <td>{{ item.fechaDesembolso | date:'shortDate' }}</td>
          <td>{{ item.fechaVencimiento | date:'shortDate' }}</td>
          <td>{{ item.totalPagado | currency }}</td>
          <td>
            <button pButton icon="pi pi-trash" class="p-button-danger p-button-sm" (click)="onDelete(item.id)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <div class="mb-6">
    <h3 class="text-lg font-semibold mb-2">Cancelados</h3>
    <p-table [value]="cancelados" [paginator]="true" [rows]="5">
      <ng-template pTemplate="header">
        <tr>
          <th>Cliente</th>
          <th>Producto</th>
          <th>Capital</th>
          <th>Intereses</th>
          <th>Mora</th>
          <th>Fecha Desembolso</th>
          <th>Fecha Vencimiento</th>
          <th>Total Pagado</th>
          <th>Acciones</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-item>
        <tr>
          <td>{{ item.clienteNombre }}</td>
          <td>{{ item.producto }}</td>
          <td>{{ item.capital | currency }}</td>
          <td>{{ item.intereses | currency }}</td>
          <td>{{ item.mora | currency }}</td>
          <td>{{ item.fechaDesembolso | date:'shortDate' }}</td>
          <td>{{ item.fechaVencimiento | date:'shortDate' }}</td>
          <td>{{ item.totalPagado | currency }}</td>
          <td>
            <button pButton icon="pi pi-trash" class="p-button-danger p-button-sm" (click)="onDelete(item.id)"></button>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

</div>
